CREATE DATABASE CONSECIONARIO;

CREATE TABLE COCHE (
    ID INT AUTO_INCREMENT NOT NULL,
    MODELO VARCHAR(50) NOT NULL,
    MARCA VARCHAR(30),
    PRECIO INT NOT NULL,
    STOCK INT NOT NULL,

    CONSTRAINT PK_COCHE PRIMARY KEY(ID)
);

CREATE TABLE GRUPO (
    ID INT AUTO_INCREMENT NOT NULL,
    NOMBRE VARCHAR(50) NOT NULL,
    CIUDAD VARCHAR(30),

    CONSTRAINT PK_GRUPO PRIMARY KEY(ID)
);

CREATE TABLE VENDEDOR (
    ID INT AUTO_INCREMENT NOT NULL,
    GRUPO_ID INT NOT NULL,
    JEFE VARCHAR(30),
    NOMBRE VARCHAR(40) NOT NULL,
    APELLIDO VARCHAR(100) NOT NULL,
    CARGO VARCHAR(50),
    SUELDO FLOAT ,
    FECHA DATE,
    COMISION FLOAT,

    CONSTRAINT PK_VENDEDOR PRIMARY KEY(ID),
    CONSTRAINT FK_VENDEDOR_GRUPO FOREIGN KEY(GRUPO_ID) REFERENCES GRUPO(ID),
    CONSTRAINT FK_VENDEDOR_JEFE FOREIGN KEY(JEFE) REFERENCES VENDEDOR(ID)
 
);


CREATE TABLE CLIENTE(
    ID INT AUTO_INCREMENT NOT NULL,
    VENDEDOR_ID INT NOT NULL,
    NOMBRE VARCHAR(50),
    APELLIDO VARCHAR (50),
    CIUDAD VARCHAR(50),
    GASTADO FLOAT,
    FECHA DATE,

    CONSTRAINT PK_CLIENTE PRIMARY KEY(ID),
    CONSTRAINT FK_CLIENTE_VENDEDOR FOREIGN KEY(VENDEDOR_ID) REFERENCES VENDEDOR(ID)
);

CREATE TABLE ENCARGO(
    ID INT AUTO_INCREMENT NOT NULL,
    CLIENTE_ID INT NOT NULL,
    COCHE_ID INT NOT NULL,
    CANTIDAD INT,
    FECHA DATE,

    CONSTRAINT PK_ENCARGO PRIMARY KEY(ID),
    CONSTRAINT FK_ENCARGO_CLIENTE FOREIGN KEY(CLIENTE_ID) REFERENCES CLIENTE(ID),
    CONSTRAINT FK_ENCARGO_COCHE FOREIGN KEY(COCHE_ID)REFERENCES COCHE(ID)
);

/*RELLENAR LA BASE DE DATOS A TRAVES DE INSERTS*/

/*COCHE*/
INSERT INTO COCHE VALUES(NULL,'PRISMA','CHEVROLET',30000000,23);
INSERT INTO COCHE VALUES(NULL,'SWIFT','SUZUKI',45000000,13);
INSERT INTO COCHE VALUES(NULL,'ACCENT','HYUNDAI',4550000,23);
INSERT INTO COCHE VALUES(NULL,'CLIO','RENAULT',30000000,23);
INSERT INTO COCHE VALUES(NULL,'LANCER','MITSUBISHI',56630000,23);

/*GRUPO*/
INSERT INTO GRUPO VALUES(NULL,'VENDEDORES A','MADRID');
INSERT INTO GRUPO VALUES(NULL,'VENDEDORES B','MADRID');
INSERT INTO GRUPO VALUES(NULL,'DIRECTOR MECANICO','MADRID');
INSERT INTO GRUPO VALUES(NULL,'VENDEDORES A','BARCELONA');
INSERT INTO GRUPO VALUES(NULL,'VENDEDORES B','BARCELONA');
INSERT INTO GRUPO VALUES(NULL,'VENDEDORES A','VALENCIA');
INSERT INTO GRUPO VALUES(NULL,'VENDEDORES B','BILBAO');
INSERT INTO GRUPO VALUES(NULL,'VENDEDORES C','SANTIAGO DE COMPOSTELA');

/*VENDEDOR*/
INSERT INTO VENDEDOR VALUES(NULL,1,NULL,'DAVID','LOPEZ','ENCARGADO DE TIENDA',30000,CURDATE(),4);
INSERT INTO VENDEDOR VALUES(NULL,1,1,'ERNESTO','PEREZ','AYUDANTE',300,CURDATE(),0.5);
INSERT INTO VENDEDOR VALUES(NULL,2,NULL,'CLAUDIO','MARTINEZ','RESPONSABLE DE TIENDA',1200,CURDATE(),4);
INSERT INTO VENDEDOR VALUES(NULL,2,3,'CAMILO','SEXTO','AYUDANTE DE TIENDA',3100,CURDATE(),4);
INSERT INTO VENDEDOR VALUES(NULL,3,NULL,'NICOLAS','LOPEZ','MECANICO EN JEFE',30000,CURDATE(),8);
INSERT INTO VENDEDOR VALUES(NULL,4,NULL,'ALBERTO','POZO','ENCARGADO DE TIENDA',30000,CURDATE(),4);
INSERT INTO VENDEDOR VALUES(NULL,5,NULL,'NORMAN','QUEZADA','ENCARGADO DE TIENDA',30000,CURDATE(),4);
INSERT INTO VENDEDOR VALUES(NULL,6,NULL,'FACUNDO','MALUENDA','ENCARGADO DE TIENDA',30000,CURDATE(),4);
INSERT INTO VENDEDOR VALUES(NULL,6,8,'LUIS','LOPEZ','ENCARGADO DE TIENDA',30000,CURDATE(),4);

/*CLIENTE*/

INSERT INTO CLIENTE VALUES(NULL,1,'MASCOTAS S.A','VENTA DE ALIMENTOS','SANTIAGO',7554000,CURDATE());
INSERT INTO CLIENTE VALUES(NULL,1,'FRUTERIA ANTONIA','VENTA DE VERDURAS','ATACAMA',96678000,CURDATE());
INSERT INTO CLIENTE VALUES(NULL,1,'PC FACTORY','TECNOLOGIA','ANTOFAGASTA',96798880,CURDATE());
INSERT INTO CLIENTE VALUES(NULL,1,'FERRETERIA S.A','REPUESTOS','IQUIQUE',3556700,CURDATE());
INSERT INTO CLIENTE VALUES(NULL,1,'AUTOMAC SERVICE','MECANICA','CONCEPCION',3507878000,CURDATE());
INSERT INTO CLIENTE VALUES(NULL,1,'CONSULTORIO SPA','MEDICINA','CALAMA',450000,CURDATE());
INSERT INTO CLIENTE VALUES(NULL,1,'FLORERIA PERESOZO','AGRICULTURA','CURICO',456460000,CURDATE());


/*ENCARGO*/

INSERT INTO ENCARGO VALUES(NULL,1,1,2,CURDATE());
INSERT INTO ENCARGO VALUES(NULL,2,2,4,CURDATE());
INSERT INTO ENCARGO VALUES(NULL,3,3,1,CURDATE());
INSERT INTO ENCARGO VALUES(NULL,4,3,3,CURDATE());
INSERT INTO ENCARGO VALUES(NULL,5,5,1,CURDATE());
INSERT INTO ENCARGO VALUES(NULL,6,6,1,CURDATE());


SELECT * FROM ENCARGO;
SELECT * FROM COCHE;
SELECT * FROM CLIENTE;
SELECT * FROM VENDEDOR;
SELECT * FROM GRUPO;


UPDATE cliente SET NOMBRE='ZMART SPA',APELLIDO='VIDEOJUEGOS' WHERE ID=7;
/*CANTIDAD DE ENCARGOS POR CLIENTE*/
SELECT CANTIDAD,NOMBRE
FROM ENCARGO , CLIENTE 
WHERE ENCARGO.CLIENTE_ID = CLIENTE.ID;


/**/

SELECT CANTIDAD,NOMBRE,MARCA,MODELO
FROM ENCARGO , CLIENTE ,COCHE
WHERE ENCARGO.CLIENTE_ID = CLIENTE.ID
AND ENCARGO.COCHE_ID = COCHE.ID;
